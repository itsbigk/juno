function adminArchiveList(e,a,r,t,n){e.type="archived",e.flash=t;var s=function(){a.all().success(function(a){e.restaurants=a})};e.go=function(e){console.log(e);var a="/admin/restaurants/"+e._id;r.path(a)},e.restoreListing=function(e){a.archive(e,{archived:!1,archiveDate:""}).success(function(e){t.setMessage(e.message),n.go("admin-archive-list",{},{reload:!0}),s()}).error(function(e){t.setMessage(e.message),n.go("admin-archive-list",{},{reload:!0})})},s()}function adminRestaurantIndex(e,a,r,t,n){e.type="list",e.flash=t;var s=function(){a.all().success(function(a){e.restaurants=a})};e.go=function(e){console.log(e);var a="/admin/restaurants/"+e._id;r.path(a)},e.archiveListing=function(e){a.archive(e,{archived:!0,archiveDate:Date.now()}).success(function(e){t.setMessage(e.message),n.go("admin-restaurant-index",{},{reload:!0}),s()}).error(function(e){t.setMessage(e.message),n.go("admin-restaurant-index",{},{reload:!0})})},s()}angular.module("Juno",["ui.router"]),angular.module("Juno").controller("adminArchiveList",adminArchiveList),adminArchiveList.$inject=["$scope","Restaurant","$location","flash","$state"],angular.module("Juno").controller("createRestaurantController",["$scope","$state","Restaurant","flash",function(e,a,r,t){function n(){$(".form-control").removeClass("error"),$(".error-message").remove()}function s(e){for(var a in e.errors){var r=e.errors[a].message.replace(/Path|`/g,"").trim(),t="#"+a;$(t).hasClass("error")||(console.log("has error: "+t),$(t+"-container").append("<div class='error-message'>"+r+"</div>")),$(t).addClass("error")}}e.flash=t,e.type="create",e.formData={},e.saveRestaurant=function(){e.processing=!0,r.create(e.formData).success(function(r){e.processing=!1,void 0===r.errors?(t.setMessage(r.message),e.formData={},n(),a.go("admin-restaurant-new",{},{reload:!0})):(n(),s(r))}).error(function(e){e.errors?s(e):(t.setMessage(e.message),a.go("admin-restaurant-new",{},{reload:!0}))})}}]),angular.module("Juno").controller("deleteRestaurantController",["$scope","Restaurant","$stateParams","$location",function(e,a,r,t){e.type="delete";var n=function(){a.all().success(function(a){e.restaurants=a})};e.go=function(e){var a="/admin/restaurants/"+e._id;t.path(a)},e.deleteRestaurant=function(r){a["delete"](r).success(function(a){e.message=a.message,n()}).error(function(a){e.message=a.message})},n()}]),angular.module("Juno").controller("editRestaurantController",["$scope","Restaurant","$stateParams","$location","flash","$state",function(e,a,r,t,n,s){function o(){$(".form-control").removeClass("error"),$(".error-message").remove()}function i(e){for(var a in e.errors){var r=e.errors[a].message.replace(/Path|`/g,"").trim(),t="#"+a;$(t).hasClass("error")||(console.log("has error: "+t),$(t+"-container").append("<div class='error-message'>"+r+"</div>")),$(t).addClass("error")}}e.flash=n,e.type="edit",a.get(r.restaurant_id).success(function(a){e.formData=a}),e.saveRestaurant=function(){e.processing=!0,a.update(r.restaurant_id,e.formData).success(function(a){e.processing=!1,void 0===a.errors?(n.setMessage(a.message),o(),s.go("admin-restaurant-index")):(o(),i(a))}).error(function(e){e.errors?i(e):(n.setMessage(e.message),s.go("admin-edit-restaurant",{},{reload:!0}))})}}]),angular.module("Juno").controller("adminRestaurantIndex",adminRestaurantIndex),adminRestaurantIndex.$inject=["$scope","Restaurant","$location","flash","$state"],angular.module("Juno").controller("viewRestaurantController",["$scope","Restaurant","$stateParams","$location",function(e,a,r,t){e.type="view",a.get(r.restaurant_id).success(function(a){e.restaurant=a})}]),angular.module("Juno").controller("homeController",["$scope","flash",function(e,a){e.flash=a}]),angular.module("Juno").filter("capitalize",function(){return function(e,a){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}});var app=angular.module("Juno");app.directive("confirmClick",function(){return{priority:-1,restrict:"A",link:function(e,a,r){var t=r.confirmation||"Are you sure?";a.bind("click",function(a){if(window.confirm(t)){var n=r.confirmClick;n&&e.$apply(e.$eval(n))}})}}}),angular.module("Juno").factory("flash",["$rootScope",function(e){var a=[],r="";return e.$on("$stateChangeSuccess",function(){r=a.shift()||""}),{setMessage:function(e){a.push(e)},getMessage:function(){return r}}}]),angular.module("Juno").factory("Restaurant",["$http",function(e){return{all:function(){return e.get("/api/restaurants")},get:function(a){return e.get("/api/restaurants/"+a)},create:function(a){return e.post("/api/restaurants",a)},update:function(a,r){return e.put("/api/restaurants/"+a,r)},archive:function(a,r){return e.patch("/api/restaurants/"+a,r)},"delete":function(a){return e["delete"]("/api/restaurants/"+a)}}}]),angular.module("Juno").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,a,r){a.otherwise("/"),e.state("/",{url:"/",controller:"homeController",templateUrl:"partials/home.html"}).state("admin",{url:"/admin",controller:"adminRestaurantIndex",templateUrl:"partials/admin/admin.html"}).state("admin-restaurant-index",{url:"/admin/restaurants",controller:"adminRestaurantIndex",templateUrl:"partials/admin/restaurants/index.html"}).state("admin-archive-list",{url:"/admin/restaurants/archive",controller:"adminArchiveList",templateUrl:"partials/admin/restaurants/archives.html"}).state("admin-delete-restaurants",{url:"/admin/restaurants/delete",controller:"deleteRestaurantController",templateUrl:"partials/admin/restaurants/index.html"}).state("admin-restaurant-new",{url:"/admin/restaurants/new",controller:"createRestaurantController",templateUrl:"partials/admin/restaurants/restaurant.html"}).state("admin-view-restaurant",{url:"/admin/restaurants/:restaurant_id",controller:"viewRestaurantController",templateUrl:"partials/admin/restaurants/viewRestaurant.html"}).state("admin-edit-restaurant",{url:"/admin/restaurants/edit/:restaurant_id",controller:"editRestaurantController",templateUrl:"partials/admin/restaurants/restaurant.html"})}]);