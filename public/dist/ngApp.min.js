function createRestaurantController(e,t,r,a,n){function o(){$(".form-control").removeClass("error"),$(".error-message").remove()}function s(e){for(var t in e.errors){var r=e.errors[t].message.replace(/Path|`/g,"").trim(),a="#"+t;$(a).hasClass("error")||(console.log("has error: "+a),$(a+"-container").append("<div class='error-message'>"+r+"</div>")),$(a).addClass("error")}}e.flash=a,e.type="create",e.formData={},e.$watch("files",function(){e.upload(e.files)}),e.policy=new Buffer({expiration:"2016-01-01T00:00:00Z",conditions:[{bucket:"s3-bucket"},["starts-with","$key","uploads/"],{acl:"public"}]}).toString("base64"),e.upload=function(e){if(e&&e.length)for(var t=0;t<e.length;t++){var r=e[t];n.upload({url:"https://angular-file-upload.s3.amazonaws.com/",method:"POST",fields:{key:r.name,AWSAccessKeyId:"AKIAINEDRF744HKGAOFA",acl:"public","Content-Type":""!=r.type?r.type:"application/octet-stream",filename:r.name},file:r}).progress(function(e){var t=parseInt(100*e.loaded/e.total);console.log("progress: "+t+"% "+e.config.file.name)}).success(function(e,t,r,a){console.log("file "+a.file.name+"uploaded. Response: "+e)})}},e.saveRestaurant=function(){e.processing=!0,r.create(e.formData).success(function(r){e.processing=!1,void 0===r.errors?(a.setMessage(r.message),e.formData={},o(),t.go("admin-restaurant-new",{},{reload:!0})):(o(),s(r))}).error(function(e){e.errors?s(e):(a.setMessage(e.message),t.go("admin-restaurant-new",{},{reload:!0}))})}}function deleteRestaurantController(e,t,r,a){e.type="delete";var n=function(){t.all().success(function(t){e.restaurants=t})};e.go=function(e){var t="/admin/restaurants/"+e._id;a.path(t)},e.deleteRestaurant=function(r){t["delete"](r).success(function(t){e.message=t.message,n()}).error(function(t){e.message=t.message})},n()}function editRestaurantController(e,t,r,a,n,o){function s(){$(".form-control").removeClass("error"),$(".error-message").remove()}function l(e){for(var t in e.errors){var r=e.errors[t].message.replace(/Path|`/g,"").trim(),a="#"+t;$(a).hasClass("error")||(console.log("has error: "+a),$(a+"-container").append("<div class='error-message'>"+r+"</div>")),$(a).addClass("error")}}e.flash=n,e.type="edit",t.get(r.restaurant_id).success(function(t){e.formData=t}),e.saveRestaurant=function(){e.processing=!0,t.update(r.restaurant_id,e.formData).success(function(t){e.processing=!1,void 0===t.errors?(n.setMessage(t.message),s(),o.go("admin-restaurant-index")):(s(),l(t))}).error(function(e){e.errors?l(e):(n.setMessage(e.message),o.go("admin-edit-restaurant",{},{reload:!0}))})}}function adminRestaurantIndex(e,t,r){e.type="list",e.message="";var a=function(){r.all().success(function(t){e.restaurants=t})};e.go=function(e){var r="/admin/restaurants/"+e._id;t.path(r)},e.archiveListing=function(t){r.archive(t).success(function(t){e.message=t.message,a()}).error(function(t){e.message=t.message})},a()}function viewRestaurantController(e,t,r,a){e.type="view",t.get(r.restaurant_id).success(function(t){e.restaurant=t})}function homeController(e,t){e.flash=t,e.key="key"}angular.module("Juno",["ui.router","ngFileUpload"]),angular.module("Juno").controller("createRestaurantController",createRestaurantController),createRestaurantController.$inject=["$scope","$state","Restaurant","flash","Upload"],angular.module("Juno").controller("deleteRestaurantController",deleteRestaurantController),deleteRestaurantController.$inject=["$scope","Restaurant","$stateParams","$location"],angular.module("Juno").controller("editRestaurantController",editRestaurantController),editRestaurantController.$inject=["$scope","Restaurant","$stateParams","$location","flash","$state"],angular.module("Juno").controller("adminRestaurantIndex",adminRestaurantIndex),adminRestaurantIndex.$inject=["$scope","$location","Restaurant"],angular.module("Juno").controller("viewRestaurantController",viewRestaurantController),viewRestaurantController.$inject=["$scope","Restaurant","$stateParams","$location"],angular.module("Juno").controller("homeController",homeController),homeController.$inject=["$scope","flash"];var app=angular.module("Juno");app.directive("confirmClick",function(){return{priority:-1,restrict:"A",link:function(e,t,r){var a=r.confirmation||"Are you sure?";t.bind("click",function(t){if(window.confirm(a)){var n=r.confirmClick;n&&e.$apply(e.$eval(n))}})}}}),angular.module("Juno").factory("flash",["$rootScope",function(e){var t=[],r="";return e.$on("$stateChangeSuccess",function(){r=t.shift()||""}),{setMessage:function(e){t.push(e)},getMessage:function(){return r}}}]),angular.module("Juno").factory("Restaurant",["$http",function(e){return{all:function(){return e.get("/api/restaurants")},get:function(t){return e.get("/api/restaurants/"+t)},create:function(t){return e.post("/api/restaurants",t)},update:function(t,r){return e.put("/api/restaurants/"+t,r)},archive:function(t,r){return e.patch("/api/restaurants/"+t,r)},"delete":function(t){return e["delete"]("/api/restaurants/"+t)}}}]),angular.module("Juno").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,r){t.otherwise("/"),e.state("/",{url:"/",controller:"homeController",templateUrl:"partials/home.html"}).state("admin",{url:"/admin",controller:"adminRestaurantIndex",templateUrl:"partials/admin/admin.html"}).state("admin-restaurant-index",{url:"/admin/restaurants",controller:"adminRestaurantIndex",templateUrl:"partials/admin/restaurants/index.html"}).state("admin-delete-restaurants",{url:"/admin/restaurants/delete",controller:"deleteRestaurantController",templateUrl:"partials/admin/restaurants/index.html"}).state("admin-restaurant-new",{url:"/admin/restaurants/new",controller:"createRestaurantController",templateUrl:"partials/admin/restaurants/restaurant.html"}).state("admin-view-restaurant",{url:"/admin/restaurants/:restaurant_id",controller:"viewRestaurantController",templateUrl:"partials/admin/restaurants/viewRestaurant.html"}).state("admin-edit-restaurant",{url:"/admin/restaurants/edit/:restaurant_id",controller:"editRestaurantController",templateUrl:"partials/admin/restaurants/restaurant.html"})}]),angular.module("Juno").filter("capitalize",function(){return function(e,t){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}});