function adminArchiveList(e,r,t,a,n){e.type="archived",e.flash=a;var o=function(){r.all().success(function(r){e.restaurants=r})};e.go=function(e){console.log(e);var r="/admin/restaurants/"+e._id;t.path(r)},e.restoreListing=function(e){r.archive(e,{archived:!1,archiveDate:""}).success(function(e){a.setMessage(e.message),n.go("admin-archive-list",{},{reload:!0}),o()}).error(function(e){a.setMessage(e.message),n.go("admin-archive-list",{},{reload:!0})})},o()}function createRestaurantController(e,r,t,a,n){function o(){$(".form-control").removeClass("error"),$(".error-message").remove()}function s(e){for(var r in e.errors){var t=e.errors[r].message.replace(/Path|`/g,"").trim(),a="#"+r;$(a).hasClass("error")||(console.log("has error: "+a),$(a+"-container").append("<div class='error-message'>"+t+"</div>")),$(a).addClass("error")}}e.$on("$viewContentLoaded",formImageInput),e.flash=a,e.type="create",e.formData={},e.saveRestaurant=function(){e.processing=!0,t.create(e.formData).success(function(t){e.processing=!1,void 0===t.errors?(a.setMessage(t.message),e.formData={},o(),r.go("admin-restaurant-new",{},{reload:!0})):(o(),s(t))}).error(function(e){e.errors?s(e):(a.setMessage(e.message),r.go("admin-restaurant-new",{},{reload:!0}))})}}function deleteRestaurantController(e,r,t,a){e.type="delete";var n=function(){r.all().success(function(r){e.restaurants=r})};e.go=function(e){var r="/admin/restaurants/"+e._id;a.path(r)},e.deleteRestaurant=function(t){r["delete"](t).success(function(r){e.message=r.message,n()}).error(function(r){e.message=r.message})},n()}function editRestaurantController(e,r,t,a,n,o){function s(){$(".form-control").removeClass("error"),$(".error-message").remove()}function i(e){for(var r in e.errors){var t=e.errors[r].message.replace(/Path|`/g,"").trim(),a="#"+r;$(a).hasClass("error")||(console.log("has error: "+a),$(a+"-container").append("<div class='error-message'>"+t+"</div>")),$(a).addClass("error")}}e.flash=n,e.type="edit",r.get(t.restaurant_id).success(function(r){e.formData=r}),e.saveRestaurant=function(){e.processing=!0,r.update(t.restaurant_id,e.formData).success(function(r){e.processing=!1,void 0===r.errors?(n.setMessage(r.message),s(),o.go("admin-restaurant-index")):(s(),i(r))}).error(function(e){e.errors?i(e):(n.setMessage(e.message),o.go("admin-edit-restaurant",{},{reload:!0}))})}}function adminFormRequestsIndex(e,r,t,a,n){e.type="list",e.flash=a;var o=function(){r.all().success(function(r){e.formRequests=r,console.log(r[1])})};o()}function adminRestaurantIndex(e,r,t,a,n){e.type="list",e.flash=a;var o=function(){r.all().success(function(r){e.restaurants=r})};e.go=function(e){var r="/admin/restaurants/"+e._id;t.path(r)},e.archiveListing=function(e){r.archive(e,{archived:!0,archiveDate:Date.now()}).success(function(e){a.setMessage(e.message),n.go("admin-restaurant-index",{},{reload:!0}),o()}).error(function(e){a.setMessage(e.message),n.go("admin-restaurant-index",{},{reload:!0})})},o()}function viewRestaurantController(e,r,t,a){e.type="view",r.get(t.restaurant_id).success(function(r){e.restaurant=r})}function homeController(e,r){e.flash=r}function landingController(e,r,t,a){function n(){var e=[{name:"Shellfish",url:"https://s3.amazonaws.com/junopay-development/general-images/shellfish.jpg"},{name:"Light & Healthy",url:"https://s3.amazonaws.com/junopay-development/general-images/healthy.jpg"},{name:"Meat",url:"https://s3.amazonaws.com/junopay-development/general-images/meat.jpg"},{name:"Fish",url:"https://s3.amazonaws.com/junopay-development/general-images/seafood.jpg"},{name:"Comfort Food",url:"https://s3.amazonaws.com/junopay-development/general-images/comfort-food.jpg"},{name:"Poultry",url:"https://s3.amazonaws.com/junopay-development/general-images/poultry.jpg"}],r=["Vegan","Vegetarian","Pescatarian","Gluten-Free","Peanut Allergy","Non-Dairy","None"],t=["less than $10","$10-$20","$20+"];return{cravings:e,preferences:r,budgets:t}}function o(){var n=angular.copy(e.formData);e.errors={},n.craving||(e.errors["food-choices"]="Please select a craving");var o=!1;for(var s in n.foodPreferences)if(n.foodPreferences.hasOwnProperty(s)){o=!0;break}if(o||(e.errors["food-preferences"]="Please select preferences"),n.budget||(e.errors.budget="Please select your budget"),n.email&&e.emailRegex.test(n.email)||(e.errors.email="Please enter a valid email"),n.zipcode&&e.zipRegex.test(n.zipcode)||(e.errors.zipcode="Please enter a valid zip code."),_.isEmpty(e.errors))r.create(n).success(function(){a.go("thank-you")}).error(function(e){console.log("error: ",e)});else{var i;for(var l in e.errors)if(e.errors.hasOwnProperty(l)){i=document.getElementById(l);break}i&&t(i)}}angular.extend(e,{formData:{foodPreferences:{},craving:void 0,budget:void 0},formOptions:n(),saveRequestForm:o,errors:{},zipRegex:/^\d{5}(-\d{4})?$/,emailRegex:/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/}),e.$watch("foodPreferenceOtherToggle",function(r){r||delete e.formData.foodPreferences.Other}),e.$watch("formData.foodPreferences",function(r){for(var t in r)r.hasOwnProperty(t)&&(r[t]===!1?delete r[t]:delete e.errors["food-preferences"])},!0)}function flash(e){var r=[],t="";return e.$on("$stateChangeSuccess",function(){t=r.shift()||""}),{setMessage:function(e){r.push(e)},getMessage:function(){return t}}}function FormRequest(e){return{all:function(){return e.get("/api/requests")},create:function(r){return e.post("/api/requests",r)},update:function(r,t){return e.put("/api/requests/"+r,t)}}}function Restaurant(e){return{all:function(){return e.get("/api/restaurants")},get:function(r){return e.get("/api/restaurants/"+r)},create:function(r){return e.post("/api/restaurants",r)},update:function(r,t){return e.put("/api/restaurants/"+r,t)},archive:function(r,t){return e.patch("/api/restaurants/"+r,t)},"delete":function(r){return e["delete"]("/api/restaurants/"+r)}}}angular.module("Juno",["ui.router","ui.bootstrap","smoothScroll"]),angular.module("Juno").controller("adminArchiveList",adminArchiveList),adminArchiveList.$inject=["$scope","Restaurant","$location","flash","$state"],angular.module("Juno").controller("createRestaurantController",createRestaurantController),createRestaurantController.$inject=["$scope","$state","Restaurant","flash"],angular.module("Juno").controller("deleteRestaurantController",deleteRestaurantController),deleteRestaurantController.$inject=["$scope","Restaurant","$stateParams","$location"],angular.module("Juno").controller("editRestaurantController",editRestaurantController),editRestaurantController.$inject=["$scope","Restaurant","$stateParams","$location","flash","$state"],angular.module("Juno").controller("adminFormRequestsIndex",adminFormRequestsIndex),adminFormRequestsIndex.$inject=["$scope","FormRequest","$location","flash","$state"],angular.module("Juno").controller("adminRestaurantIndex",adminRestaurantIndex),adminRestaurantIndex.$inject=["$scope","Restaurant","$location","flash","$state"],angular.module("Juno").controller("viewRestaurantController",viewRestaurantController),viewRestaurantController.$inject=["$scope","Restaurant","$stateParams","$location"],angular.module("Juno").controller("homeController",homeController),homeController.$inject=["$scope","flash"],angular.module("Juno").controller("landingController",landingController),landingController.$inject=["$scope","FormRequest","smoothScroll","$state"],angular.module("Juno").directive("confirmClick",function(){return{priority:-1,restrict:"A",link:function(e,r,t){var a=t.confirmation||"Are you sure?";r.bind("click",function(r){if(window.confirm(a)){var n=t.confirmClick;n&&e.$apply(e.$eval(n))}})}}}),angular.module("Juno").directive("imageUpload",function(){return{restrict:"E",templateUrl:"../../../partials/admin/restaurants/image-upload.html",link:function(e,r,t){function a(){var r=e.formData.name;r&&(r=r.replace(/[^\w\s]|_/g," ").replace(/\s+/g,"_"));var t=Date.now().toString();return[t,r].join("_")}e.s3Upload=function(r){new S3Upload({s3_object_name:a(),file_dom_selector:"image",s3_sign_put_url:"/sign_s3",onFinishS3Put:function(r){console.log(r),e.formData.imageUrl=r,console.log(e.formData.imageUrl)},onError:function(e){flash.setMessage(e)}})}}}}),angular.module("Juno").filter("capitalize",function(){return function(e,r){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}}),angular.module("Juno").factory("flash",flash),flash.$inject=["$rootScope"],angular.module("Juno").factory("FormRequest",FormRequest),FormRequest.$inject=["$http"],angular.module("Juno").factory("Restaurant",Restaurant),Restaurant.$inject=["$http"],angular.module("Juno").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,r,t){r.otherwise("/"),e.state("/",{url:"/",controller:"landingController",templateUrl:"partials/home.html"}).state("thank-you",{url:"/thankyou",templateUrl:"partials/thankyou.html"}).state("admin-formrequests-index",{url:"/admin/requests/6331400",controller:"adminFormRequestsIndex",templateUrl:"partials/admin/form-requests/index.html"})}]);