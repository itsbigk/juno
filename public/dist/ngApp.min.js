angular.module("Juno",["ui.router"]),angular.module("Juno").controller("createRestaurantController",["$scope","$state","Restaurant",function(e,a,r){function t(){$(".form-control").removeClass("error"),$(".error-message").remove()}e.type="create",e.formData={},e.saveRestaurant=function(){console.log(e.formData),e.processing=!0,e.message="",r.create(e.formData).success(function(a){if(console.log("success!"),console.log("data: ",a),e.processing=!1,void 0===a.errors)e.message=a.message,e.formData={},t();else{console.log(a),t();for(var r in a.errors){e.message=a.message;var n=a.errors[r].message.replace(/Path|`/g,"").trim(),s="#"+r;$(s).hasClass("error")||(console.log("has error: "+s),$(s+"-container").append("<div class='error-message'>"+n+"</div>")),$(s).addClass("error")}}}).error(function(a){e.message=a.message})}}]),angular.module("Juno").controller("deleteRestaurantController",["$scope","Restaurant","$stateParams",function(e,a,r){e.type="delete";var t=function(){a.all().success(function(a){e.restaurants=a})};e.deleteRestaurant=function(r){a["delete"](r).success(function(a){e.message=a.message,t()}).error(function(a){e.message=a.message})},t()}]),angular.module("Juno").controller("editRestaurantController",["$scope","Restaurant","$stateParams","$location","$filter",function(e,a,r,t,n){function s(){$(".form-control").removeClass("error"),$(".error-message").remove()}e.type="edit",a.get(r.restaurant_id).success(function(a){e.formData=a,e.formData.name=n("capitalize")(e.formData.name),e.formData.street=n("capitalize")(e.formData.street),e.formData.city=n("capitalize")(e.formData.city),e.formData.state=n("capitalize")(e.formData.state),e.formData.cuisine=n("capitalize")(e.formData.cuisine)}),e.saveRestaurant=function(){e.formData.name=n("capitalize")(e.formData.name),e.formData.street=n("capitalize")(e.formData.street),e.formData.city=n("capitalize")(e.formData.city),e.formData.state=n("capitalize")(e.formData.state),e.formData.cuisine=n("capitalize")(e.formData.cuisine),console.log(e.formData),e.processing=!0,e.message="",a.update(r.restaurant_id,e.formData).success(function(a){console.log("success!"),console.log("data: ",a),e.processing=!1,void 0===a.errors&&(e.message=a.message,s())}).error(function(a){s();for(var r in a.errors){e.message=a.message;var t=a.errors[r].message.replace(/Path|`/g,"").trim(),n="#"+r;$(n).hasClass("error")||(console.log("has error: "+n),$(n+"-container").append("<div class='error-message'>"+t+"</div>")),$(n).addClass("error")}})}}]),angular.module("Juno").controller("adminRestaurantIndex",["$scope","Restaurant",function(e,a){e.type="list",e.message="";var r=function(){a.all().success(function(a){e.restaurants=a})};e.archiveListing=function(t){a.update(t,{archived:!0}).success(function(a){e.message="Restaurant archived successfully!",r()}).error(function(a){e.message="Restaurant was not archived"})},r()}]),angular.module("Juno").controller("homeController",["$scope",function(e){e.hey="hey"}]);var app=angular.module("Juno");app.directive("confirmClick",function(){return{priority:-1,restrict:"A",link:function(e,a,r){var t=r.confirmation||"Are you sure?";a.bind("click",function(a){if(window.confirm(t)){var n=r.confirmClick;n&&e.$apply(e.$eval(n))}})}}}),angular.module("Juno").filter("capitalize",function(){return function(e,a){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}}),angular.module("Juno").factory("Restaurant",["$http",function(e){return{all:function(){return e.get("/api/restaurants")},get:function(a){return e.get("/api/restaurants/"+a)},create:function(a){return e.post("/api/restaurants",a)},update:function(a,r){return e.put("/api/restaurants/"+a,r)},"delete":function(a){return e["delete"]("/api/restaurants/"+a)}}}]),angular.module("Juno").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,a,r){a.otherwise("/"),e.state("/",{url:"/",controller:"homeController",templateUrl:"partials/home.html"}).state("admin",{url:"/admin",controller:"adminRestaurantIndex",templateUrl:"partials/admin/admin.html"}).state("admin-restaurant-index",{url:"/admin/restaurants",controller:"adminRestaurantIndex",templateUrl:"partials/admin/restaurants/index.html"}).state("admin-delete-restaurants",{url:"/admin/restaurants/delete",controller:"deleteRestaurantController",templateUrl:"partials/admin/restaurants/index.html"}).state("admin-restaurant-new",{url:"/admin/restaurants/new",controller:"createRestaurantController",templateUrl:"partials/admin/restaurants/restaurant.html"}).state("admin-edit-restaurant",{url:"/admin/restaurants/:restaurant_id",controller:"editRestaurantController",templateUrl:"partials/admin/restaurants/restaurant.html"})}]);