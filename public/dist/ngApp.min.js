angular.module("Juno",["ui.router"]),angular.module("Juno").controller("createRestaurantController",["$scope","$state","Restaurant","flash",function(e,r,t,a){function n(){$(".form-control").removeClass("error"),$(".error-message").remove()}e.flash=a,e.type="create",e.formData={},e.saveRestaurant=function(){e.processing=!0,t.create(e.formData).success(function(r){if(console.log("success!"),console.log("data: ",r),e.processing=!1,void 0===r.errors)console.log("runs if"),a.setMessage(r.message),e.formData={},n();else{console.log("runs else"),console.log(r),n();for(var t in r.errors){a.setMessage(r.message);var s=r.errors[t].message.replace(/Path|`/g,"").trim(),o="#"+t;$(o).hasClass("error")||(console.log("has error: "+o),$(o+"-container").append("<div class='error-message'>"+s+"</div>")),$(o).addClass("error")}}}).error(function(e){a.setMessage("Temporary Error Message")}),r.go("admin-restaurant-new",{},{reload:!0})}}]),angular.module("Juno").controller("deleteRestaurantController",["$scope","Restaurant","$stateParams",function(e,r,t){e.type="delete";var a=function(){r.all().success(function(r){e.restaurants=r})};e.deleteRestaurant=function(t){r["delete"](t).success(function(r){e.message=r.message,a()}).error(function(r){e.message=r.message})},a()}]),angular.module("Juno").controller("editRestaurantController",["$scope","Restaurant","$stateParams","$location","flash","$state",function(e,r,t,a,n,s){function o(){$(".form-control").removeClass("error"),$(".error-message").remove()}e.flash=n,e.type="edit",r.get(t.restaurant_id).success(function(r){e.formData=r}),e.saveRestaurant=function(){e.processing=!0,r.update(t.restaurant_id,e.formData).success(function(r){console.log("success!"),console.log("data: ",r),e.processing=!1,void 0===r.errors&&(n.setMessage(r.message),o(),s.go("admin-restaurant-index"))}).error(function(e){o();for(var r in e.errors){n.setMessage(e.message);var t=e.errors[r].message.replace(/Path|`/g,"").trim(),a="#"+r;$(a).hasClass("error")||(console.log("has error: "+a),$(a+"-container").append("<div class='error-message'>"+t+"</div>")),$(a).addClass("error"),s.go("admin-edit-restaurant",{},{reload:!0})}})}}]),angular.module("Juno").controller("adminRestaurantIndex",["$scope","Restaurant",function(e,r){e.type="list",e.message="";var t=function(){r.all().success(function(r){e.restaurants=r})};e.archiveListing=function(a){r.update(a,{archived:!0}).success(function(r){e.message="Restaurant archived successfully!",t()}).error(function(r){e.message="Restaurant was not archived"})},t()}]),angular.module("Juno").controller("homeController",["$scope","flash",function(e,r){e.flash=r}]);var app=angular.module("Juno");app.directive("confirmClick",function(){return{priority:-1,restrict:"A",link:function(e,r,t){var a=t.confirmation||"Are you sure?";r.bind("click",function(r){if(window.confirm(a)){var n=t.confirmClick;n&&e.$apply(e.$eval(n))}})}}}),angular.module("Juno").filter("capitalize",function(){return function(e,r){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}}),angular.module("Juno").factory("flash",["$rootScope",function(e){var r=[],t="";return e.$on("$stateChangeSuccess",function(){t=r.shift()||""}),{setMessage:function(e){r.push(e),console.log(e)},getMessage:function(){return t}}}]),angular.module("Juno").factory("Restaurant",["$http",function(e){return{all:function(){return e.get("/api/restaurants")},get:function(r){return e.get("/api/restaurants/"+r)},create:function(r){return e.post("/api/restaurants",r)},update:function(r,t){return e.put("/api/restaurants/"+r,t)},"delete":function(r){return e["delete"]("/api/restaurants/"+r)}}}]),angular.module("Juno").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,r,t){r.otherwise("/"),e.state("/",{url:"/",controller:"homeController",templateUrl:"partials/home.html"}).state("admin",{url:"/admin",controller:"adminRestaurantIndex",templateUrl:"partials/admin/admin.html"}).state("admin-restaurant-index",{url:"/admin/restaurants",controller:"adminRestaurantIndex",templateUrl:"partials/admin/restaurants/index.html"}).state("admin-delete-restaurants",{url:"/admin/restaurants/delete",controller:"deleteRestaurantController",templateUrl:"partials/admin/restaurants/index.html"}).state("admin-restaurant-new",{url:"/admin/restaurants/new",controller:"createRestaurantController",templateUrl:"partials/admin/restaurants/restaurant.html"}).state("admin-edit-restaurant",{url:"/admin/restaurants/:restaurant_id",controller:"editRestaurantController",templateUrl:"partials/admin/restaurants/restaurant.html"})}]);